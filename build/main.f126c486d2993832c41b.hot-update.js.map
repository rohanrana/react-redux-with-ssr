{"version":3,"file":"main.f126c486d2993832c41b.hot-update.js","sources":["webpack:///./src/server.js"],"sourcesContent":["import express from \"express\";\nimport { matchRoutes } from \"react-router-config\";\nimport Routes from \"./Routes\";\nimport createStore from \"./redux/store\";\nimport renderer from \"./renderer\";\nconst server = express();\n\nserver\n  .disable(\"x-powered-by\")\n  .use(express.static(process.env.RAZZLE_PUBLIC_DIR))\n  .get(\"*\", (req, res) => {\n    //server side configuring store\n    const store = createStore(req);\n\n    // itrating routes and get its component and\n    // associated functions to set data at server side\n    const promises = matchRoutes(Routes, req.path)\n      .map(({ route }) => {\n        return route.loadData ? route.loadData(store) : null;\n      })\n      .map(promise => {\n        if (promise) {\n          return new Promise((resolve, reject) => {\n            promise.then(resolve).catch(resolve);\n          });\n        }\n      });\n    // making process parallel for each route to be hit.\n    Promise.all(promises).then(() => {\n      const context = {};\n      const content = renderer(req, store, context);\n      if (context.url) {\n        res.redirect(301, context.url);\n      }\n      if (context.notFound) {\n        res.status(404);\n      }\n      res.send(content);\n    });\n  });\n\nexport default server;\n"],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAIA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAEA;;;;A","sourceRoot":""}