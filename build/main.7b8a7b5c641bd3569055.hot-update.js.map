{"version":3,"file":"main.7b8a7b5c641bd3569055.hot-update.js","sources":["webpack:///./src/server.js"],"sourcesContent":["\nimport express from \"express\";\nimport { matchRoutes } from \"react-router-config\";\nimport Routes from \"./Routes\";\nimport createStore from \"./redux/store\";\nimport renderer from \"./renderer\";\nconst server = express();\n\nserver\n  .disable(\"x-powered-by\")\n  .use(express.static(process.env.RAZZLE_PUBLIC_DIR))\n  .get(\"/*\", (req, res) => {\n\n    // console.log(\"REQ STORE\",req)\n    const store = createStore(req);\n\n    const promises = matchRoutes(Routes, req.path).map(({ route }) => {\n      console.log(\"routes\", route);\n\n      return route.loadData ? route.loadData(store) : null;\n    }).map(promise=>{\n      if(promise)\n      {\n        return new Promise((resolve,reject)=>{\n          promise.then(resolve).catch(resolve)\n        })\n      }\n    });\n    Promise.all(promises).then(() => {\n      const context = {};\n      const content = renderer(req, store, context);\n      console.log(\"Context\", context);\n  \n  \n      if(context.url){\n        res.redirect(301,context.url)\n      }\n      if (context.notFound) {\n        res.status(404);\n      }\n      res.send(content);\n    });\n  \n\n    //     console.log(\"Request\",req)\n    //     const context = {};\n\n    //     const markup = renderToString(\n    //       <Provider store={store}>\n    //         <StaticRouter context={context} location={req.url}>\n    //           <App />\n    //         </StaticRouter>\n    //       </Provider>\n    //     );\n    //     if (context.url) {\n    //       res.redirect(context.url);\n    //     } else {\n    //       res.status(200).send(\n    //         `<!doctype html>\n    //     <html lang=\"\">\n    //     <head>\n    //         <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n    //         <meta charset=\"utf-8\" />\n    //         <title>Welcome to Razzle</title>\n    //         <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    //         ${\n    //           assets.client.css\n    //             ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">`\n    //             : \"\"\n    //         }\n    //         ${\n    //           process.env.NODE_ENV === \"production\"\n    //             ? `<script src=\"${assets.client.js}\" defer></script>`\n    //             : `<script src=\"${assets.client.js}\" defer crossorigin></script>`\n    //         }\n    //         <script>\n    //         window.INTIAL_STATE =${serialize(store.getState())}\n    //        </script>\n    //     </head>\n    //     <body>\n    //         <div id=\"root\">${markup}</div>\n    //     </body>\n    // </html>`\n    //       );\n    //     }\n  });\n\n  server.listen(3000,'Listenig...')\n// export default server;\n"],"mappings":";;;;;;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAKA;AACA;AAEA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;A","sourceRoot":""}